# 历史记录功能测试指南

## 功能概述
历史记录功能允许用户查看他们浏览过的问题，按时间倒序排列（最新的在最上面）。

## 测试步骤

### 1. 启动服务
```bash
# 后端服务
cd backend
python manage.py runserver

# 前端服务
cd frontend
npm run dev
```

### 2. 登录测试
1. 访问 http://localhost:5173/login
2. 使用现有账户登录或注册新账户

### 3. 浏览问题测试
1. 在主页或问题列表中点击任意问题
2. 查看问题详情页面
3. 重复浏览几个不同的问题

### 4. 查看历史记录
1. 点击导航栏中的时钟图标（历史记录）
2. 验证历史记录是否正确显示：
   - 问题标题
   - 问题分类
   - 浏览时间（相对时间，如"5分钟前"）
   - 问题状态
3. 点击历史记录项，验证是否能跳转到对应问题

### 5. 测试清空功能
1. 在历史记录弹窗中点击"清空历史"按钮
2. 确认弹窗提示
3. 验证历史记录是否被清空

### 6. 测试时间排序
1. 浏览几个不同的问题
2. 查看历史记录，验证最新的问题显示在最上面

## 预期结果

### 历史记录显示内容
- ✅ 问题标题
- ✅ 问题分类（带颜色标签）
- ✅ 浏览时间（相对时间格式）
- ✅ 问题状态（带颜色徽章）

### 功能特性
- ✅ 按时间倒序排列
- ✅ 点击跳转到问题详情
- ✅ 清空历史记录功能
- ✅ 加载状态显示
- ✅ 错误处理
- ✅ 空状态提示

### 状态徽章颜色
- 🟡 待审核：黄色
- 🔵 处理中：蓝色
- 🟢 已解决：绿色
- ⚫ 已关闭：灰色

## 技术实现

### 后端API
- `GET /feedback/view-history/` - 获取历史记录
- `POST /feedback/issues/{id}/record-view/` - 记录浏览
- `DELETE /feedback/view-history/clear/` - 清空历史

### 前端组件
- `useViewHistory` Hook - 状态管理
- `HistoryModal` - 历史记录弹窗
- 自动记录浏览历史

### 数据流程
1. 用户浏览问题 → 调用 `recordView` API
2. 打开历史记录 → 调用 `getViewHistory` API
3. 清空历史 → 调用 `clearHistory` API

## 注意事项
- 需要用户登录才能记录和查看历史
- 每个用户对每个问题只记录一次最新浏览时间
- 历史记录按浏览时间倒序排列
- 支持相对时间显示（如"5分钟前"）
